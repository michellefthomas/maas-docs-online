<?xml version="1.0" encoding="utf-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
<head>
<meta charset="utf-8" />

<title>How to Use the Solace Cloud REST API to Manage Users</title>
<link rel="stylesheet" href="Resources/Stylesheets/MainStyles-full-docs.css" type="text/css" />
</head>
<body>
<div class="document" id="how-to-use-the-solace-cloud-rest-api-to-manage-users">
<h1 class="title">How to Use the Solace Cloud REST API to Manage Users</h1>

<p>In addition our messaging service APIs, Solace PubSub+ Cloud has introduced REST APIs and token support for account user management. This allows administrators to create, update, and delete users from their account programmatically.</p>
<p>In this blog post, I’ll show you how you can:</p>
<ol class="arabic simple">
<li><p>Grab an API token from Solace Cloud using your account</p></li>
<li><p>Use that API token to invite a new user to your account</p></li>
<li><p>Retrieve user info</p></li>
<li><p>Update user permissions</p></li>
<li><p>Delete a user from your account</p></li>
</ol>
<p>The tutorial assumes you know what REST is and kind of know how to send REST requests using your favorite tool. But it's okay if you don’t. <a class="reference external" href="https://www.restapitutorial.com/lessons/whatisrest.html">Check out this REST intro</a> and then come back.</p>
<div class="section" id="setup">
<h1>Setup</h1>
<p>What you'll need:</p>
<ul class="simple">
<li><p>A Solace PubSub+ Cloud Enterprise Account. As only Enterprise Accounts support multiple users, these REST endpoints cannot be used otherwise.</p></li>
<li><p>Administrator permissions for your account.</p></li>
<li><p>You need a way to send REST messages from your dev environment. Postman (6.1.3 or greater) is a good choice if you want a visual REST API Dev Tool</p></li>
<li><p>Click this <a class="reference external" href="https://documenter.getpostman.com/view/4953125/RztsomaP">link to import the Postman collection</a> then hit the “Run in Postman” button.</p></li>
</ul>
<div class="section" id="installing-postman">
<h2>Installing Postman</h2>
<p>If you don’t have Postman installed when you hit “Run in Postman”, it will prompt you to install it (which doesn’t take long). Once Postman is installed, you will need to shut it down and click on the “Run in Postman” link again to import the Postman collection.
If you prefer using CURL, the Postman link above provides the sample CURL commands.</p>
</div>
</div>
<div class="section" id="create-an-api-token">
<h1>Create an API Token</h1>
<p>You need an API token to authenticate and authorize REST requests. When creating an API token, you will configure what permissions it has (i.e., a subset of the permissions you have when you log in to Solace Cloud)</p>
<ol class="arabic simple">
<li><p>Log in to Solace Cloud</p></li>
<li><p>Click on your name in the right side of the menu bar to navigate to Token Management.</p></li>
</ol>
<a class="reference external image-reference" href="https://console.solace.cloud/api-tokens"><img alt="../img/userApi_1.png" src="Resources/Images/userApi_1.png" /></a>
<ol class="arabic simple" start="3">
<li><p>Click the “Create Token” button</p></li>
</ol>
<a class="reference external image-reference" href="https://console.solace.cloud/api-tokens"><img alt="../img/userApi_2.png" src="Resources/Images/userApi_2.png" /></a>
<ol class="arabic simple" start="4">
<li><p>Give the Token a name and enable these permissions:</p></li>
</ol>
<blockquote>
<ul class="simple">
<li><p>Get Users</p></li>
<li><p>Get Roles</p></li>
<li><p>Create User</p></li>
<li><p>Delete Users</p></li>
<li><p>Put Roles</p></li>
</ul>
<p>Note: If you don't see these permissions listed in the Create Token menu, you may not have adequate (administrator) permissions for your account. Touch base with your account administrator to request access, or contact PubSub+ Cloud support if there is a problem with your permissions.</p>
</blockquote>
<a class="reference external image-reference" href="https://console.solace.cloud/api-tokens/create"><img alt="../img/userApi_3.png" src="Resources/Images/userApi_3.png" /></a>
<ol class="arabic simple" start="5">
<li><p>Click the “Generate Token” button</p></li>
<li><p>Copy the token to your clipboard by clicking the “Copy” button. <strong>Note:</strong> You will not see this again for security reasons. If you lose the token, you can always regenerate the token or create a new one.</p></li>
<li><p>Set up Postman Collection Authorization – In order for Postman to send REST to Solace Cloud, you need to set the token you just created</p></li>
</ol>
<blockquote>
<ol class="loweralpha simple">
<li><p>Set the Postman Environment to <strong>Solace PubSub+ Cloud</strong> -- look in the drop down in the upper left part of the Postman window.</p></li>
</ol>
<img alt="../img/userApi_4.png" src="Resources/Images/userApi_4.png" />
<ol class="loweralpha simple" start="2">
<li><p>Edit the Solace PubSub+ Cloud environment and set the token by clicking on eye icon next to the environment drop down. Then click Edit next to <strong>Solace PubSub+ Environment</strong>.</p></li>
<li><p>Paste the token in the value field of the <strong>apiToken</strong> key and then click Update.</p></li>
</ol>
<img alt="../img/userApi_5.png" src="Resources/Images/userApi_5.png" />
</blockquote>
<p><strong>Great!</strong> Now we have a token, and Postman is set up to use it!</p>
<p>Let’s use it to do some stuff.</p>
</div>
<div class="section" id="create-a-user-using-the-rest-api">
<h1>Create a User using the REST API</h1>
<p>Now that we have a token, we can use it call the user REST endpoint to create a user.</p>
<ol class="arabic simple">
<li><p>In the Postman Collection “<em>Solace Blogs – Solace Cloud User Management</em>”, select the request “<strong>POST Invite User</strong>”</p></li>
</ol>
<img alt="../img/userApi_6.png" src="Resources/Images/userApi_6.png" />
<ol class="arabic simple" start="2">
<li><p>Change the 'email' field to the email address of the user you wish to invite, then click on the Send button</p></li>
</ol>
<img alt="../img/userApi_7.png" src="Resources/Images/userApi_7.png" />
<p>You should see a JSON response confirming that a user was invited.</p>
<p>Now go back to the Solace Cloud Account Management page and you should the invited user.</p>
<img alt="../img/userApi_8.png" src="Resources/Images/userApi_8.png" />
<p>Awesome! You have just invited a user. The email address provided should recieve an invitation email which will guide the user through the rest of the activation process.</p>
</div>
<div class="section" id="get-user-details">
<h1>Get User Details</h1>
<p>Now let’s retrieve user details.</p>
<ol class="arabic simple">
<li><p>In the Postman Collection “<em>Solace Blogs – Solace Cloud User Management</em>”, select the request “<strong>Get User in Account</strong>”</p></li>
</ol>
<img alt="../img/userApi_9.png" src="Resources/Images/userApi_9.png" />
<ol class="arabic simple" start="2">
<li><p>The previous 'Invite User' step should have already populated the required 'userId' variable in the path. Click on the Send button</p></li>
</ol>
<img alt="../img/userApi_10.png" src="Resources/Images/userApi_10.png" />
<p>You should be able to see the details of the user.</p>
</div>
<div class="section" id="assign-roles-to-a-user">
<h1>Assign Roles to a User</h1>
<p>Now that we've created and retrieved our new user, we'll try changing the roles assigned to them.</p>
<p>First, we'll want to look at a list of roles we can assign.</p>
<ol class="arabic simple">
<li><p>In the Postman Collection “<em>Solace Blogs – Solace Cloud User Management</em>”, select the request “<strong>Get Roles in Account</strong>”</p></li>
</ol>
<img alt="../img/userApi_11.png" src="Resources/Images/userApi_11.png" />
<ol class="arabic simple" start="2">
<li><p>Click on the Send button</p></li>
</ol>
<img alt="../img/userApi_12.png" src="Resources/Images/userApi_12.png" />
<p>You should be able to see a list of available roles, each with a list of permissions they contain.</p>
<p>Now, to change the role of our user.</p>
<ol class="arabic simple">
<li><p>In the Postman Collection “<em>Solace Blogs – Solace Cloud User Management</em>”, select the request “<strong>PUT Set Roles for User</strong>”</p></li>
</ol>
<img alt="../img/userApi_13.png" src="Resources/Images/userApi_13.png" />
<ol class="arabic simple" start="2">
<li><p>In the body of the request, we see 'messaging-service-editor'. the 'id' will line up with the 'id' field of one of the roles returned in the previous step. This will replace the user's existing roles when we send the request. Click on the Send button</p></li>
</ol>
<img alt="../img/userApi_14.png" src="Resources/Images/userApi_14.png" />
<p>In the JSON response, there is a list of roles which are now assigned to the user. The user can now create and delete services, rather than just viewing them.</p>
</div>
<div class="section" id="delete-a-user">
<h1>Delete a User</h1>
<p>Now that we've used our user to test out the management APIs, we may want to clean up.</p>
<ol class="arabic simple">
<li><p>In the Postman Collection “<em>Solace Blogs – Solace Cloud User Management</em>”, select the request “<strong>Delete User</strong>”</p></li>
</ol>
<img alt="../img/userApi_15.png" src="Resources/Images/userApi_15.png" />
<ol class="arabic simple" start="2">
<li><p>Click on the Send button</p></li>
</ol>
<img alt="../img/userApi_16.png" src="Resources/Images/userApi_16.png" />
<p>You should receive a 200 OK response confirming that the delete request was accepted.</p>
</div>
</div>
</body>
</html>